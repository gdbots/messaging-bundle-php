{#
  Require libraries:
    - http://abpetkov.github.io/switchery/
#}

<script type="text/javascript">
  var switcheryRegistry = switcheryRegistry || {
    instances: [],

    addInstance: function(id, switchery) {
      this.instances[id] = switchery;
    },
    getInstance: function(id) {
      return this.instances[id] || null;
    }
  };
  var wbq = wbq || [];
  wbq.push(function initSwitchery_{{ widgetId }}() {
    require(
    [
      'jquery',
      'switchery'
    ],
    function ($, Switchery) {
      'use strict';

      var field = document.getElementById('{{ widgetId }}');
      var switchery = new Switchery(field, {{ options|default([])|json_encode|raw }});
      $(field).data('switchery', switchery);

      switcheryRegistry.addInstance('{{ widgetId }}', switchery);
    });
  });
</script>
